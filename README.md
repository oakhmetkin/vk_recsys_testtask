# Тестовое задание в RecSys VK

---

## Задача
**Датасет:** [датасет](https://www.kaggle.com/competitions/kkbox-music-recommendation-challenge/data) прослушиваний музыки.

**Задача:** на основе этих данных построить рекомендательную систему релевантных треков для пользователей и оценить ее качество.

**Метрика:** NDCG@20.

**Что будет оцениваться:**

1. Наличие и содержательность exploratory data analysis
2. Пайплайн обучения модели: подготовка данных, feature engineering, выбор модели, выбор loss функции, корректная оценка метрик качества
3. Наличие и содержательность комментариев к происходящему
4. Финальный скор

---

## Summary

**Разделы ноутбука:**
- Fetching dataset - скачивание данных, распаковка и пр.
- EDA - анализ и обработка данных
- CatBoostClassifier - обучение классификатора на target, evaluation классификатора
- Recommendations - реализация рекомендаций, оценка ранжирования, подсчет метрики NDCG@20

**Results:**
1. Проанализированы и предобработаны данные

2. Обучена модель бинарной классификации - градиентный бустинг

3. Реализован алгоритм ранжирования на основе псевдовероятностей из бустинга

4. Подсчитаны метрики NDCG@20 в 3 случаях:
    1. NDCG@20=0.8356 при positive_count=10
    2. NDCG@20=0.6754 при positive_count=5
    3. NDCG@20=0.5944 при positive_count=3
    
5. Во всех случаях алгоритм показал себя лучше, чем базовый (рандомное ранжирование)

---

## Evaluation

- $DCG@k=\Sigma_{i=1}^k {{rel_i} \over {log_2(1 + i)}}$,

- $IDCG@k=\Sigma_{i=1}^k {{rel_i} \over {log_2(1 + i)}}$,

где $rel_i$ - релевантность i-ой песни, совпадает с $true\_target_i$

**Нужная метрика:**

$NDCG@k={{DCG@k} \over {IDCG@k}}$
